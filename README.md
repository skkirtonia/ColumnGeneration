# Solving large-scale problem using Column Generation
## Problem Statement

A paper mill produces rolls of paper of a fixed width $L$ that are subsequently cut into smaller rolls according to the customer orders. The orders are given as demands for each width. Based on the demand, the suppose $W$ is the set of unique widths in all orders. The demad for each width $w \in W$ is  $d_w$. The objective of the paper mill is to satisfy the demand with the smallest possible number of paper rolls in order to minimize the losses.

## Column generation formulation
| **Sets**    | <!-- -->    |
|----|---|
| $K$  | Set of orders|
| $C$  | Set of configurations |
|**Index**|<!-- --> |
| $k$  | Index of orders |
| $c$ | Index of rolls |
|**Parameter**|<!-- --> |
| $L$  | Length of rolls |
| $l_k$  | length of roll in order $k$ |
| $d_k$  | demand of roll in order $k$ |
| $n_{ck}$  | Number of roll of order $k$ in configuration $c$|
| $\lambda_k$  | Dual value of order $k$|
|**Decision Variable**|<!-- --> |
| $x_c$  | Number of configurations of $c$ selected to meet the demand|
| $y_k$  | Number of small roll of order $c$ cut from a roll|


### Master Problem
$min$  $\sum_{c \in C} x_c$ </br>
$s.t.$  $\sum_{c \in C} n_{ck} x_c \geq d_k \quad \forall k \in K$ </br>
$~~~~~~$ $x_c \geq 0$ and $integer </br>

### Sub-problem
$min$  $1-\sum_{k \in K} \lambda_k y_k$ </br>
$s.t.$ $\sum_{k \in K} l_k y_k \leq L$ </br>
$~~~~~~$ $y_k \geq 0$ and $integer$ </br>

## Column Generation Procedure

**Step 1**: Solve the LP-relaxation of the master problem. Get the dual values $\lambda_k$ for each order $k$. </br></br>
**Step 2**: Using $\lambda_k$ solve the sub-problem. There are two cases can arise. *Case 1*: If the objective is less than 0, a new column can be generated that can improve the objective of the master problem. A new column is generated by using the values of $y_k$ which indicates that we should cut $y_k$ many roll of order $k$. This new configuration is added to the set of existing configuration $C$ and go to **Step 1**. *Case 2*: If the objective is not less than 0, there solution of the master problem can not be improved further by adding any new configurations. Go to **Step 3**. </br></br>
**Step 3**: Solve the master problem as Integer Programming to solve the main problem.

## A naive MILP formulation

| **Sets**    | <!-- -->    |
|----|---|
| $K$  | Set of orders|
| $R$  | Set of rolls |
|**Index**|<!-- --> |
| $k$  | Index of orders |
| $r$ | Index of rolls |
|**Parameter**|<!-- --> |
| $L$  | Length of rolls |
| $l_k$  | length of roll in order $k$ |
| $d_k$  | demand of roll in order $k$ |
|**Decision Variable**|<!-- --> |
| $x_{kr}$  | Number of smaller rolls of width $k$ cut from roll $r$|
| $y_r$  | 1 if roll $r$ is used|

$min$  $\sum_{r \in R} y_r$ </br>
$s.t.$  $\sum_{k \in W} l_k x_{kr} \leq L \quad \forall r \in R$ </br>
$~~~~~~$ $My_r \geq x_{kr} \quad \forall r \in R, \quad \forall k \in K$ </br>
$~~~~~~$ $\sum_{r \in R} x_{kr} \geq d_k \quad \forall k \in K$ </br>
$~~~~~~$ $y_r \in \{0, 1\}$ </br>
$~~~~~~$ $x_{kr} \geq 0 \quad and \quad integer$ </br>
